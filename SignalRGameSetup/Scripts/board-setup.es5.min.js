"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function saveBoard(){}function getCoordinates(n){var t=undefined,i=undefined;return n.substring(1,2)==="0"?(t=parseInt(n.substring(0,2)),i=parseInt(n.substring(3,n.length))):(t=parseInt(n.substring(0,1)),i=parseInt(n.substring(2,n.length))),[t,i]}function addSquares(n){for(var e,i,o=document.getElementById(n),u=30,r=5,f=5,t=0;t<=10;t++){for(e=function(n){var i=document.createElement("div"),c,e,s,h;i.style.position="absolute";i.style.display="flex";i.style.justifyContent="center";i.style.alignItems="center";i.style.left=r+"px";i.style.top=f+"px";i.id="square"+t+"-"+n;r+=u+5;t===0&n===0?i.className="square empty":t===0||n===0?(i.className="square info",t===0&&n!=0?i.innerText=n:t!=0&&n===0&&(c=VERTICAL_INFO[t-1],i.innerText=c)):(i.className="square",i.id="square"+t+"-"+n,i.setAttribute("hasShip",!1),i.setAttribute("hasPeg",!1),i.setAttribute("hasPreview",!1),i.setAttribute("position",t+"-"+n),i.addEventListener("click",function(){clickSquare(i.getAttribute("position"))}),i.addEventListener("mouseover",function(){mouseOverSquare(i.getAttribute("position"))}),e=document.createElement("div"),e.className="peg-hole",e.id="pegHole"+t+"-"+n,i.appendChild(e),s=document.createElement("div"),s.className="ship-preview hide",s.id="preview"+t+"-"+n,i.appendChild(s),h=document.createElement("img"),h.id="ship"+t+"-"+n,h.className="ship hide",i.appendChild(h));o.appendChild(i)},i=0;i<=10;i++)e(i);f+=u+5;r=5}}function clickSquare(n){lastShipLog("First method: clickSquare");isSettingShips&&currentShip!=null&&setShip(n)}function mouseOverSquare(n){var s=document.getElementById("square"+n),y=document.getElementById("preview"+n),i=getCoordinates(n),l,e,h,a,u,r,f,t,c,o,v;if(isSettingShips&&firstPosition.length!=0&&previewPositions.length!=0&&previousPosition.length!=0)if(isInPreviews(i)&&s.getAttribute("hasPreview")=="true"){for(l=getPreviewIndex(i),previousPosition=i,e=[],t=0;t<previewPositions.length;t++)e.push(previewPositions[t]);for(t=l+1;t<previewPositions.length;t++)h=document.getElementById("preview"+previewPositions[t][0]+"-"+previewPositions[t][1]),h.setAttribute("hasPreview",!1),e.splice(t,1),h.className="ship-preview hide",squareCount--;previewPositions=e;previewPositions.length==1&&(previewDirection=null)}else if(isNextTo(i,previousPosition))squareCount===1&&(previewDirection=getDirection(i,previousPosition)),previewDirection===getDirection(i,previousPosition)&&(s.setAttribute("hasPreview",!0),previewPositions.push(i),squareCount++,a=document.getElementById("preview"+previousPosition[0]+"-"+previousPosition[1]),y.className=s.getAttribute("hasShip")=="true"||a.className==="ship-preview error"?"ship-preview error":isFinalPreviewSquare(i)?"ship-preview last":isBeyondFinalPreviewSquare(i)?"ship-preview error":"ship-preview");else if(isInRow(i)){for(previewLog("********************************************"),previewLog("isInRow(positionCoordinates) WAS SUCCESSFUL"),previewLog("********************************************"),u=getRowIndexAndDirection(i),previewLog("positionInfo:"),previewLog("direction: "+u.direction),previewLog("index: "+u.index),previewLog("rowPositions: "+u.rowPositions),previewDirection===null&&(previewDirection=u.direction),r=getPositionsToChange(firstPosition,u),previewPositions.length>1&&(squareCount=previewPositions.length),squareCount=previewPositions.length,f=!1,t=0;t<r.length;t++)c=document.getElementById("square"+r[t][0]+"-"+r[t][1]),o=document.getElementById("preview"+r[t][0]+"-"+r[t][1]),c.setAttribute("hasPreview",!0),v=[r[t][0],r[t][1]],isInPreviews(v)||(previewPositions.push(r[t]),squareCount++),f||o.className!=="ship-preview error"||(f=!0),c.getAttribute("hasShip")=="true"||f?(o.className="ship-preview error",f=!0):o.className=isFinalPreviewSquare(r[t])?"ship-preview last":isBeyondFinalPreviewSquare(r[t])?"ship-preview error":"ship-preview";previewLog("Preview Positions after adding positions: "+previewPositions);previewLog("____________________________________________")}}function isFinalPreviewSquare(n){var i=!1,t;return isSettingShips&&firstPosition.length!=0&&previewDirection!=null&&currentShip!=null&&(t=getFinalPreviewSquare(),t[0]===n[0]&&t[1]===n[1]&&(i=!0)),i}function isBeyondFinalPreviewSquare(n){var i=!1,t;return isSettingShips&&firstPosition.length!=0&&previewDirection!=null&&currentShip!=null&&(t=getFinalPreviewSquare(),previewDirection==="north"?n[0]>t[0]&&n[1]===t[1]&&(i=!0):previewDirection==="south"?n[0]<t[0]&&n[1]===t[1]&&(i=!0):previewDirection==="west"?n[0]===t[0]&&n[1]>t[1]&&(i=!0):previewDirection==="east"&&n[0]===t[0]&&n[1]<t[1]&&(i=!0)),i}function getFinalPreviewSquare(){var n=[],t=currentShip.Length-1;return isSettingShips&&firstPosition.length!=0&&previewDirection!=null&&currentShip!=null&&(previewDirection==="north"?n=[firstPosition[0]+t,firstPosition[1]]:previewDirection==="south"?n=[firstPosition[0]-t,firstPosition[1]]:previewDirection==="west"?n=[firstPosition[0],firstPosition[1]+t]:previewDirection==="east"&&(n=[firstPosition[0],firstPosition[1]-t])),n}function isInPreviews(n){if(previewPositions.length===0)return!1;for(var t=previewPositions.length-1;t>=0;t--)if(n[0]===previewPositions[t][0]&&n[1]===previewPositions[t][1])return!0;return!1}function getPreviewIndex(n){if(previewPositions.length===0)return-1;for(var t=previewPositions.length-1;t>=0;t--)if(n[0]===previewPositions[t][0]&&n[1]===previewPositions[t][1])return t;return-1}function isNextTo(n,t){var i=[t[0]-1,t[1]],r=[t[0]+1,t[1]],u=[t[0],t[1]-1],f=[t[0],t[1]+1];return n[0]===i[0]&&n[1]===i[1]||n[0]===r[0]&&n[1]===r[1]||n[0]===u[0]&&n[1]===u[1]||n[0]===f[0]&&n[1]===f[1]?!0:!1}function getPositionsToChange(n,t){var u=[],f=t.index+1,i,r;if(t.direction==="north")for(i=1;i<=f;i++)if(r=[n[0]+i,n[1]],r[0]>10||r[0]<1)break;else u.push(r);else if(t.direction==="west")for(i=1;i<=f;i++)if(r=[n[0],n[1]+i],r[1]>10||r[1]<1)break;else u.push(r);else if(t.direction==="south")for(i=1;i<=f;i++)if(r=[n[0]-i,n[1]],r[0]>10||r[0]<1)break;else u.push(r);else if(t.direction==="east")for(i=1;i<=f;i++)if(r=[n[0],n[1]-i],r[1]>10||r[1]<1)break;else u.push(r);return u}function isInRow(n){var t=!1,i;if(firstPosition.length!=0){var r=[],u=[],f=[],e=[];for(i=1;i<=BOARD_SIZE;i++){var o=[firstPosition[0]+i,firstPosition[1]],s=[firstPosition[0],firstPosition[1]+i],h=[firstPosition[0]-i,firstPosition[1]],c=[firstPosition[0],firstPosition[1]-i];r.push(o);u.push(s);f.push(h);e.push(c)}if(previewDirection!=null)return previewDirection==="north"?t=checkArrayForPosition(r,n):previewDirection==="west"?t=checkArrayForPosition(u,n):previewDirection==="south"?t=checkArrayForPosition(f,n):previewDirection==="east"&&(t=checkArrayForPosition(e,n)),t;if((t=checkArrayForPosition(r,n),previewLog("North?: "+t),t===!0)||(t=checkArrayForPosition(u,n),previewLog("West?: "+t),t===!0)||(t=checkArrayForPosition(f,n),previewLog("South?: "+t),t===!0)||(t=checkArrayForPosition(e,n),previewLog("East?: "+t),t===!0))return previewLog("END OF isInRow() METHOD - RESULT: "+t),t}else previewLog("Ln: 388 No firstPosition - result = "+t);return previewLog("END OF isInRow() METHOD - RESULT: "+t),t}function getRowIndexAndDirection(n){var t={rowPositions:[],direction:null,index:-1},r,i;if(firstPosition.length!=0){var u=[],f=[],e=[],o=[];for(r=1;r<=BOARD_SIZE;r++){var s=[firstPosition[0]+r,firstPosition[1]],h=[firstPosition[0],firstPosition[1]+r],c=[firstPosition[0]-r,firstPosition[1]],l=[firstPosition[0],firstPosition[1]-r];u.push(s);f.push(h);e.push(c);o.push(l)}if(t.direction===null)if(i=checkArrayForPosition(u,n),i===!1)if(i=checkArrayForPosition(f,n),i===!1)if(i=checkArrayForPosition(e,n),i===!1){if(i=checkArrayForPosition(o,n),i===!1)return null;t.direction="east"}else t.direction="south";else t.direction="west";else t.direction="north";if(previewLog("result.direction: "+t.direction),t.direction!=null)return previewLog("Ln: 490 (result.direction != null)"),t.direction==="north"?(t.rowPositions=u,t.index=getArrayIndexOfPosition(u,n)):t.direction==="west"?(t.rowPositions=f,t.index=getArrayIndexOfPosition(f,n)):t.direction==="south"?(t.rowPositions=e,t.index=getArrayIndexOfPosition(e,n)):t.direction==="east"&&(t.rowPositions=u,t.index=getArrayIndexOfPosition(o,n)),previewLog("END OF getRowAndIndex(coordinates) METHOD"),previewLog("-----------------------------------------"),t}else previewLog("Ln: 513 No firstPosition - result = "+t);return(t.rowPositions.length===0||t.index===-1)&&(t=null),previewLog("END OF getRowAndIndex(coordinates) METHOD - RESULT: "+t),previewLog("-----------------------------------------"),t}function checkArrayForPosition(n,t){for(var i=0;i<n.length;i++)if(n[i][0]===t[0]&&n[i][1]===t[1])return!0;return!1}function getArrayIndexOfPosition(n,t){for(var i=0;i<n.length;i++)if(n[i][0]===t[0]&&n[i][1]===t[1])return i;return-1}function getDirection(n,t){var i=[t[0]+1,t[1]],r=[t[0]-1,t[1]],u=[t[0],t[1]+1],f=[t[0],t[1]-1];return n[0]===i[0]&&n[1]===i[1]?"north":n[0]===r[0]&&n[1]===r[1]?"south":n[0]===u[0]&&n[1]===u[1]?"west":n[0]===f[0]&&n[1]===f[1]?"east":null}function getDirectionUsingIndex(n,t,i){previewLog("getDirectionUsingIndex(coordinates, previous, index)");var r=[t[0]+i,t[1]],u=[t[0]-i,t[1]],f=[t[0],t[1]+i],e=[t[0],t[1]-i];return n[0]===r[0]&&n[1]===r[1]?"north":n[0]===u[0]&&n[1]===u[1]?"south":n[0]===f[0]&&n[1]===f[1]?"west":n[0]===e[0]&&n[1]===e[1]?"east":null}function getDifferenceUsingIndex(n,t,i){previewLog("getDirectionUsingIndex(coordinates, previous, index)");var r=[t[0]+i,t[1]],u=[t[0]-i,t[1]],f=[t[0],t[1]+i],e=[t[0],t[1]-i];return n[0]===r[0]&&n[1]===r[1]?"north":n[0]===u[0]&&n[1]===u[1]?"south":n[0]===f[0]&&n[1]===f[1]?"west":n[0]===e[0]&&n[1]===e[1]?"east":null}function setShip(n){var i=document.getElementById("square"+n),r=document.getElementById("preview"+n),t=getCoordinates(n),u;i.getAttribute("hasShip")=="false"&&i.getAttribute("hasPeg")=="false"&&(i.getAttribute("hasPreview")=="true"&&firstPosition.length!=0&&firstPosition[0]===t[0]&&firstPosition[1]===t[1]?(r.className="ship-preview hide",firstPosition.length=0,previousPosition.length=0,previewPositions.length=0,i.setAttribute("hasPreview",!1),squareCount=0):firstPosition.length===0?(firstPosition=t,previousPosition=t,previewPositions.push(t),r.className="ship-preview",i.setAttribute("hasPreview",!0),squareCount=1):isFinalPreviewSquare(t)&&(u=checkForRed(),u||(currentShip.Length!=previewPositions.length&&eliminateExtraPreviewPositions(),greenPreview=t,placeShipOnBoard(),goToNextShip())))}function placeShipPosition(n,t){var i,r,f,u;previewLog("placeShipPosition(positionId)");i="\\Images\\Ships\\"+currentShip.Name.toLowerCase()+"-"+currentShip.Direction+"-"+(t+1)+".png";currentShip.Positions[n].YPos=previewPositions[t][0];currentShip.Positions[n].XPos=previewPositions[t][1];currentShip.Positions[n].Image=i;gameInformation.Board.PlayerBoard.Positions[n].HasShip=!0;gameInformation.Board.PlayerBoard.Positions[n].Image=i;r=document.getElementById("ship"+n);r.className="ship";r.src=i;f=document.getElementById("preview"+n);f.className="preview hide";u=document.getElementById("square"+n);u.setAttribute("hasShip",!0);u.setAttribute("hasPreview",!1)}function placeShipOnBoard(){var n,t;for(previewLog("placeShipOnBoard()"),currentShip.Direction=previewDirection,currentShip.IsSet=!0,n=0;n<currentShip.Length;n++)t=previewPositions[n][0]+"-"+previewPositions[n][1],placeShipPosition(t,n)}function checkForRed(){for(var t,n=0;n<previewPositions.length;n++)if(t=document.getElementById("preview"+previewPositions[n][0]+"-"+previewPositions[n][1]),t.className.includes("error"))return!0;return!1}function startSettingShips(){isSettingShips=!0;shipArray=[];shipArray.push(gameInformation.Board.PlayerBoard.Ships.Battleship);shipArray.push(gameInformation.Board.PlayerBoard.Ships.Carrier);shipArray.push(gameInformation.Board.PlayerBoard.Ships.Cruiser);shipArray.push(gameInformation.Board.PlayerBoard.Ships.Destroyer);shipArray.push(gameInformation.Board.PlayerBoard.Ships.Submarine);shipIndex=0;currentShip=shipArray[shipIndex]}function eliminateExtraPreviewPositions(){var t,n;for(lastShipLog("Ln 819: previewPositions before: "+previewPositions),t=[],n=0;n<previewPositions.length;n++)containPosition(previewPositions[n],t)?lastShipLog("NOT adding position "+previewPositions[n]+" to new array"):(lastShipLog("adding position "+previewPositions[n]+" to new array"),t.push(previewPositions[n]));lastShipLog("Setting new array");previewPositions=t;previewPositions.length!=currentShip.Length&&(lastShipLog("splicing off unnecessary positions"),previewPositions=previewPositions.splice(0,currentShip.Length));lastShipLog("previewPositions after: "+previewPositions)}function containPosition(n,t){lastShipLog("Does the array "+t+" contain position "+n+"?");for(var i=0;i<t.length;i++)if(t[i][0]===n[0]&&t[i][1]===n[1])return lastShipLog("true"),!0;return lastShipLog("false"),!1}function goToNextShip(){var n;for(console.log("****************Going to the next ship*******************"),n=currentShip.Length-1;n>=0;n--){var t=previewPositions[n][0]+"-"+previewPositions[n][1],i=document.getElementById("square"+t),r=document.getElementById("preview"+t);if(currentShip.Length!=previewPositions.length&&eliminateExtraPreviewPositions(),i.getAttribute("hasShip")=="false"||i.getAttribute("hasPreview")=="true"||r.className!="preview hide")placeShipPosition(t,n);else break}saveBoard();squareCount=0;firstPosition.length=0;previousPosition.length=0;finalPosition.length=0;previewPositions.length=0;previewDirection=null;allowSet=!0;greenPreview=null;shipIndex++;shipIndex>=shipArray.length?stopSettingShips():currentShip=shipArray[shipIndex]}function stopSettingShips(){isSettingShips=!1;currentShip=null;shipIndex=0;shipArray=null}function previewLog(n){showPreviewLogs&&console.log(n)}function lastShipLog(n){showLastShipSquareLogs&&console.log(n)}var showPreviewLogs=!0,showLastShipSquareLogs=!1,VERTICAL_INFO=["A","B","C","D","E","F","G","H","I","J"],BOARD_SIZE=10,TestShipClass=function TestShipClass(n,t){_classCallCheck(this,TestShipClass);this.Name=n;this.Length=t;this.Direction=null;this.Positions=[];this.IsSet=!1;this.IsSunk=!1},TestPositionClass=function TestPositionClass(n,t,i){_classCallCheck(this,TestPositionClass);this.XPos=n;this.YPos=t;this.Image=i;this.IsHit=!1},testShip=new TestShipClass("Carrier",5),isSettingShips=!0,currentShip=null,shipIndex=0,squareCount=0,firstPosition=[],previousPosition=[],finalPosition=[],previewPositions=[],previewDirection=null,shipArray=null,allowSet=!0,greenPreview=null;document.body.addEventListener("load",function(){addSquares(playerBoard)});document.body.onload=addSquares("playerBoard");